<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        font-family: "Arial", sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #1a191b;
      }

      #sudoku-board {
        display: grid;
        grid-template-columns: repeat(9, 40px);
        grid-template-rows: repeat(9, 40px);
        gap: 1px;
        background-color: lightblue;
      }

      .cell {
        width: 40px;
        height: 40px;
        border: 1px solid #000;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        cursor: pointer;
        user-select: none;
      }

      .cell:hover {
        background-color: lightgrey;
      }

      .given {
        background-color: #fdd0d5;
      }

      .error {
        background-color: #ffcccc;
      }

      .cell:nth-child(3n),
      .cell:nth-child(3n + 1),
      .cell:nth-child(3n + 2) {
        border-right: 2px solid #000;
        border-bottom: 2px solid #000;
      }

      #sudoku-board .cell:nth-child(9n-8) ~ .cell {
        border-bottom: 2px solid #000;
      }
    </style>
    <title>Sudoku</title>
  </head>
  <body>
    <div id="sudoku-board"></div>

    <script>
      const board = generateRandomBoard();

      const sudokuBoard = document.getElementById("sudoku-board");

      for (let i = 0; i < 9; i++) {
        for (let j = 0; j < 9; j++) {
          const cell = document.createElement("div");
          cell.classList.add("cell");
          cell.textContent = board[i][j] !== 0 ? board[i][j] : "";
          if (board[i][j] !== 0) {
            cell.classList.add("given");
          }
          sudokuBoard.appendChild(cell);

          cell.addEventListener("click", () => {
            if (!cell.classList.contains("given")) {
              const value = prompt("sayi gir (1-9):");
              const num = parseInt(value);
              if (!isNaN(num) && num >= 1 && num <= 9) {
                if (isValidMove(board, i, j, num)) {
                  board[i][j] = num;
                  cell.textContent = num;
                  cell.classList.remove("error");
                } else {
                  alert("olmaz. duzgun sayi gir.");
                  cell.classList.add("error");
                }
              } else {
                alert("sayi gir sayi.");
              }
            }
          });
        }
      }

      function isValidMove(board, row, col, num) {
        for (let i = 0; i < 9; i++) {
          if (board[row][i] === num || board[i][col] === num) {
            return false;
          }
        }

        const startRow = Math.floor(row / 3) * 3;
        const startCol = Math.floor(col / 3) * 3;
        for (let i = 0; i < 3; i++) {
          for (let j = 0; j < 3; j++) {
            if (board[startRow + i][startCol + j] === num) {
              return false;
            }
          }
        }

        return true;
      }

      function generateRandomBoard() {
        const base = [
          [5, 3, 0, 0, 7, 0, 0, 0, 0],
          [6, 0, 0, 1, 9, 5, 0, 0, 0],
          [0, 9, 8, 0, 0, 0, 0, 6, 0],
          [8, 0, 0, 0, 6, 0, 0, 0, 3],
          [4, 0, 0, 8, 0, 3, 0, 0, 1],
          [7, 0, 0, 0, 2, 0, 0, 0, 6],
          [0, 6, 0, 0, 0, 0, 2, 8, 0],
          [0, 0, 0, 4, 1, 9, 0, 0, 5],
          [0, 0, 0, 0, 8, 0, 0, 7, 9],
        ];

        const shuffled = base.map((row) => row.slice());
        shuffleArray(shuffled.flat()); // Shuffle all numbers
        for (let i = 0; i < 9; i += 3) {
          for (let j = 0; j < 9; j += 3) {
            const subgrid = shuffled
              .slice(i, i + 3)
              .map((row) => row.slice(j, j + 3));
            shuffleArray(subgrid.flat());
            for (let k = 0; k < 3; k++) {
              for (let l = 0; l < 3; l++) {
                shuffled[i + k][j + l] = subgrid[k][l];
              }
            }
          }
        }
        return shuffled;
      }

      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }
    </script>
  </body>
</html>
